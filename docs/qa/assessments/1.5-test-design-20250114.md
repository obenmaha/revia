# Test Design: Story 1.5 - Historique et Statistiques

Date: 2025-01-14
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 24
- Unit tests: 12 (50%)
- Integration tests: 8 (33%)
- E2E tests: 4 (17%)
- Priority distribution: P0: 8, P1: 10, P2: 6

## Test Scenarios by Acceptance Criteria

### AC1: Historique chronologique des séances avec filtres

#### Scenarios

| ID           | Level       | Priority | Test                                   | Justification                 |
| ------------ | ----------- | -------- | -------------------------------------- | ----------------------------- |
| 1.5-UNIT-001 | Unit        | P0       | Validation des filtres par période     | Logique de filtrage pure      |
| 1.5-UNIT-002 | Unit        | P0       | Validation des filtres par type        | Logique de filtrage pure      |
| 1.5-INT-001  | Integration | P0       | Récupération des sessions avec filtres | Multi-composant avec Supabase |
| 1.5-E2E-001  | E2E         | P1       | Flux complet de filtrage               | Parcours utilisateur critique |

### AC2: Statistiques de fréquence, durée et tendance RPE

#### Scenarios

| ID           | Level       | Priority | Test                                | Justification                |
| ------------ | ----------- | -------- | ----------------------------------- | ---------------------------- |
| 1.5-UNIT-003 | Unit        | P0       | Calcul de la fréquence hebdomadaire | Algorithme de calcul pur     |
| 1.5-UNIT-004 | Unit        | P0       | Calcul de la durée totale           | Algorithme de calcul pur     |
| 1.5-UNIT-005 | Unit        | P0       | Calcul de la tendance RPE           | Algorithme de calcul pur     |
| 1.5-INT-002  | Integration | P1       | Mise à jour des statistiques        | Intégration avec les données |
| 1.5-E2E-002  | E2E         | P1       | Affichage des statistiques          | Validation visuelle          |

### AC3: Interface de visualisation des données

#### Scenarios

| ID           | Level       | Priority | Test                                   | Justification              |
| ------------ | ----------- | -------- | -------------------------------------- | -------------------------- |
| 1.5-UNIT-006 | Unit        | P1       | Rendu des graphiques                   | Composant de visualisation |
| 1.5-UNIT-007 | Unit        | P1       | Formatage des données                  | Utilitaires de formatage   |
| 1.5-INT-003  | Integration | P1       | Chargement des données pour graphiques | Intégration données/UI     |
| 1.5-E2E-003  | E2E         | P2       | Navigation dans les graphiques         | Interaction utilisateur    |

### AC4: Export des données en CSV/PDF

#### Scenarios

| ID           | Level       | Priority | Test                            | Justification                |
| ------------ | ----------- | -------- | ------------------------------- | ---------------------------- |
| 1.5-UNIT-008 | Unit        | P0       | Génération du CSV               | Logique d'export pure        |
| 1.5-UNIT-009 | Unit        | P0       | Génération du PDF               | Logique d'export pure        |
| 1.5-UNIT-010 | Unit        | P0       | Validation des données d'export | Validation des données       |
| 1.5-INT-004  | Integration | P1       | Export complet avec filtres     | Intégration complète         |
| 1.5-E2E-004  | E2E         | P1       | Flux d'export utilisateur       | Parcours utilisateur complet |

## Risk Coverage

### Performance Risks (PERF-001, PERF-002, PERF-003)

| Test ID      | Risk Mitigated | Test Type                               |
| ------------ | -------------- | --------------------------------------- |
| 1.5-UNIT-011 | PERF-001       | Test de performance avec 1000+ sessions |
| 1.5-UNIT-012 | PERF-002       | Test de performance des calculs         |
| 1.5-INT-005  | PERF-003       | Test de rendu des graphiques            |

### Data Risks (DATA-001, DATA-002)

| Test ID     | Risk Mitigated | Test Type                     |
| ----------- | -------------- | ----------------------------- |
| 1.5-INT-006 | DATA-001       | Test d'intégrité des exports  |
| 1.5-INT-007 | DATA-002       | Test de cohérence des données |

### Security Risks (SEC-001)

| Test ID     | Risk Mitigated | Test Type                    |
| ----------- | -------------- | ---------------------------- |
| 1.5-INT-008 | SEC-001        | Test de sécurité des exports |

## Recommended Execution Order

1. P0 Unit tests (fail fast)
   - 1.5-UNIT-001, 1.5-UNIT-002, 1.5-UNIT-003, 1.5-UNIT-004, 1.5-UNIT-005, 1.5-UNIT-008, 1.5-UNIT-009, 1.5-UNIT-010

2. P0 Integration tests
   - 1.5-INT-001, 1.5-INT-004

3. P0 E2E tests
   - 1.5-E2E-001, 1.5-E2E-004

4. P1 tests in order
   - 1.5-UNIT-006, 1.5-UNIT-007, 1.5-INT-002, 1.5-INT-003, 1.5-E2E-002

5. P2+ as time permits
   - 1.5-E2E-003, 1.5-INT-005, 1.5-INT-006, 1.5-INT-007, 1.5-INT-008

## Test Data Requirements

### Performance Test Data

- 1000+ sessions avec exercices
- Données sur 2+ années
- Sessions de différents types
- Données avec RPE variés

### Export Test Data

- Sessions avec notes longues
- Données avec caractères spéciaux
- Sessions avec exercices multiples
- Données sensibles (RGPD)

### UI Test Data

- Sessions avec statistiques extrêmes
- Données manquantes ou nulles
- Sessions avec exercices vides
- Données avec erreurs de format

## Test Environment Requirements

### Unit Tests

- Vitest avec mocks Supabase
- Données de test en mémoire
- Mocks des composants Recharts

### Integration Tests

- Base de données de test Supabase
- Données réalistes
- Tests de performance

### E2E Tests

- Playwright avec données complètes
- Tests sur mobile et desktop
- Tests de performance réelle

## Quality Checklist

- [x] Every AC has test coverage
- [x] Test levels are appropriate (not over-testing)
- [x] No duplicate coverage across levels
- [x] Priorities align with business risk
- [x] Test IDs follow naming convention
- [x] Scenarios are atomic and independent
- [x] Performance tests cover critical risks
- [x] Export tests cover data integrity
- [x] UI tests cover user interactions
